<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Manual | HapiRESTServer</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
  <script src="script/matomo.js"></script>
<meta name="description" content="Template for Hapi Rest Server"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="HapiRESTServer"><meta property="twitter:description" content="Template for Hapi Rest Server"></head>
<body class="layout-container manual-root manual-index" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a href="swagger/index.html">API</a>
  <a id="healthcheck" href="">Healthcheck</a>

  <script>
    var el = document.getElementById('healthcheck')
    if (window.location.href.indexOf('github') == -1) {
      el.href = '../../admin/status';
    } else {
      el.style.color = 'grey';
      el.style.cursor = 'not-allowed';
      el.title = 'Unavailable on Github Hosting'
    }
  </script>
<a style="position:relative; top:3px;" href="https://github.com/devlinjunker/template.hapi.rest"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.setup.html"><a href="manual/README.setup.html" data-ice="link">Setup</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.setup.html"><a href="manual/README.setup.html#webpack" data-ice="link">Webpack</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.setup.html"><a href="manual/README.setup.html#documentation" data-ice="link">Documentation</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.setup.html"><a href="manual/README.setup.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.entry.html"><a href="manual/README.entry.html" data-ice="link">Application Entry Point</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.entry.html"><a href="manual/README.entry.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.logging.html"><a href="manual/README.logging.html" data-ice="link">Logging</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.logging.html"><a href="manual/README.logging.html#configurations" data-ice="link">Configurations</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.logging.html"><a href="manual/README.logging.html#what-we-log" data-ice="link">What we log</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.logging.html"><a href="manual/README.logging.html#other-processes" data-ice="link">Other processes</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.logging.html"><a href="manual/README.logging.html#logrotate" data-ice="link">Logrotate</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.logging.html"><a href="manual/README.logging.html#pino-pretty" data-ice="link">Pino-Pretty</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.logging.html"><a href="manual/README.logging.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.controllers.html"><a href="manual/README.controllers.html" data-ice="link">Controllers</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.controllers.html"><a href="manual/README.controllers.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.dataservices.html"><a href="manual/README.dataservices.html" data-ice="link">Dataservices</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.dataservices.html"><a href="manual/README.dataservices.html#examples" data-ice="link">Examples</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.dataservices.html"><a href="manual/README.dataservices.html#note-dataservice" data-ice="link">Note Dataservice</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.dataservices.html"><a href="manual/README.dataservices.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.helpers.html"><a href="manual/README.helpers.html" data-ice="link">Helpers</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.helpers.html"><a href="manual/README.helpers.html#examples" data-ice="link">Examples</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.helpers.html"><a href="manual/README.helpers.html#mariadb" data-ice="link">MariaDB</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.helpers.html"><a href="manual/README.helpers.html#config" data-ice="link">Config</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.helpers.html"><a href="manual/README.helpers.html#healthcheck" data-ice="link">Healthcheck</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.helpers.html"><a href="manual/README.helpers.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.scripts.html"><a href="manual/README.scripts.html" data-ice="link">Git Hooks/Workflow</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.scripts.html"><a href="manual/README.scripts.html#on-commit" data-ice="link">On commit</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.scripts.html"><a href="manual/README.scripts.html#github-actions" data-ice="link">Github Actions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.scripts.html"><a href="manual/README.scripts.html#on-master-pr" data-ice="link">On Master PR</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/README.scripts.html"><a href="manual/README.scripts.html#on-merge-to-master" data-ice="link">On Merge to Master</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.test.html"><a href="manual/README.test.html" data-ice="link">Test</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.test.html"><a href="manual/README.test.html#notes-ideas" data-ice="link">Notes/Ideas</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown">
  <div class="manual-user-index" data-ice="manualUserIndex"><h1 id="template-rest-api-docs">Template REST API Docs</h1><ul>
<li><a href="manual/README.setup.html">Setup</a> - dependencies and how to install and start development (eventually
production?)</li>
<li><a href="manual/README.entry.html">Entry Point</a></li>
<li><a href="manual/README.logging.html">Logging</a> - Explains how logs works and how to add/view them as a developer</li>
<li><a href="manual/README.controllers.html">Controllers</a> - mappings from url endpoints to methods for handling requests</li>
<li><a href="manual/README.dataservices.html">Dataservices</a> - classes/methods that connect to external services or datastores</li>
<li><a href="manual/README.helpers.html">Helpers</a> - classes that are used frequently for interacting with other systems/tools</li>
<li><a href="manual/README.hooks.html">Git Hooks</a> - Notes about workflow enforcements</li>
<li><a href="manual/README.test.html">Test</a> - files used to run the unit tests (eventually automated tests)</li>
</ul>
<p>.</p>
</div>

  

  <div class="manual-cards">
    
  <div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Setup</h1><p><strong>Requires Node 10+</strong>. Please install this before attempting to run. The easiest way to install and
manage node versions is by using the <a href="https://github.com/nvm-sh/nvm">Node Version Manager</a>. We define a .nvm file
in the project to help reference this minimum node version.</p><p>Use <code>nvm use 10</code> to switch node versions after installing a new Node version. <strong>Then you should install all
project dependencies</strong>(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/package.json#L30">github</a>)
with <code>npm install</code> (or <code>npm install -D</code> if development work is planned). This should install the Hapi Server Framework,
 MariaDB and other libraries used in this project.</p><p>If you have cloned the master branch, then the build should compile and all tests should pass once the
dependencies have been downloaded and installed. To only compile the server, use <code>npm run build</code>, or you can
just run the tests with <code>npm run test</code>. <strong>To watch the files for changes and rebuild/retest the files
on changes, you can use</strong> <code>npm run start-watch</code>. See the package.json(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/package.json#L17">github</a>)
for all possibe npm commands.</p><p>The Note Controller/Dataservice Endpoints require MariaDB installed to store the notes passed. After you
have installed mariadb, you will need to set up the initial database using mariadb and a SQL program (or
scripts if we get working). <strong>Once the db is set up, the configuration for the database name, user, password
and port are set in</strong> <code>conf/config.yaml</code>
(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/conf/config.yaml">github</a>).</p><p><strong>Each endpoint that is created should have an OpenAPI representation in</strong> <code>openapi.yaml</code>. This file can be
used to run <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a> to help with running/testing the processes
developed. There is a Swagger application at the API link in the docs or can view the raw
file(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/openapi.yaml">github</a>) (Eventually we will autogenerate OpenAPI file from code annotations
and create Postman test suites based on these files)</p><h2>Webpack</h2><p>Webpack config file(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/webpack.config.js">github</a>)
is used to manage our webpack build to compile the application.</p><p>In this file we:</p><ul>
<li>designate the files that will be created with the build</li>
<li>define the source mapping that will be generated with the output (this should be changed in prod)</li>
<li>set the target environment and available globals</li>
<li>define where we should look to import files</li>
<li>and set up modules/plugins for the build<ul>
<li>Babel and ESLint Loaders</li>
<li>Flow Integration with Webpack</li>
<li>Hot Module Replacement for rebuilding on file changes</li>
<li>Webpack Shell Plugin to re-run Mocha tests on file changes/rebuild</li>
</ul>
</li>
</ul><h2>Documentation</h2><p>The <code>docs/</code> directory is created with <code>npm run doc</code>, this generates an esdoc webpage based on the modified
template stored in <code>docs/template</code>.</p><p>The Dependency Graph is created with <a href="https://github.com/pahen/madge">Madge</a> and graphviz, you will need to
install both in order to update the dependency graph. I didn&apos;t include these in the package.json dependencies
because I felt this is more than is needed to develop a working app or even write basic documentation.</p><p>Install madge with <code>npm install -g madge</code> and install graphviz with <code>brew install graphviz</code> or
<code>port install graphviz</code> (for OSX)</p><p>I split this out to a separate npm script: <code>npm run doc-image</code></p><h2>Notes/Ideas</h2><ul>
<li><strong>IDEA:</strong>  init scripts with installation and SQL setup</li>
<li>Explore madge options: <a href="https://www.npmjs.com/package/madge#configuration">https://www.npmjs.com/package/madge#configuration</a></li>
</ul></div>
        <a data-ice="link" href="manual/README.setup.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Application Entry Point</h1><p>The main method(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/src/entry.js.html#L47">github</a>)
is where we instantiate the server wrapper class, and set up the routes to be handled by our application. We
also want to make ensure the application is closed down as calmly as possible when the user asks, so we make
sure to nicely ask our server to shut itself down and then ask mariadb to close any open
connections(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/src/entry.js.html#L71">github</a>).</p><p>I think we also added the handler for <code>unhandledRejection</code>
exceptions(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/src/entry.js.html#L83">github</a>)
so that we print the error to output before exiting (We may also want to log this to any notification system)</p><h2>Notes/Ideas</h2><ul>
<li><strong>IDEA:</strong> Generic Handler/Middleware that creates Request Details Object to pass to each controller</li>
</ul></div>
        <a data-ice="link" href="manual/README.entry.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Logging</h1><p>We are currently using pino for logging. Pino logs objects/messages directly to streams so other processes can
actually handle formatting or other log actions (this is because Node is single threaded, so smarter to create
another process to manage the logs). We store all of these logs in <code>&lt;CONFIG.LOG.dir&gt;/pino.log</code></p><h2>Configurations</h2><p>Some settings can be configured in the config.yaml(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/conf/config.yaml#L12">github</a>) file:</p><ul>
<li>The <code>debug</code> property shows error messages and stack traces in the stdout of the server process (for
 development)</li>
<li>The <code>dir</code> property defines the directory to save log files in</li>
<li>The <code>level</code> property defines the log level we show in pino.log</li>
</ul><h2>What we log</h2><ul>
<li>Request Log<ul>
<li>We record all connections to endpoints with the request details</li>
</ul>
</li>
<li>Errors<ul>
<li>Any Errors during request execution will be recorded in the log</li>
</ul>
</li>
<li>Developer Messages (via Logger provided methods in Route Controllers)<ul>
<li>Messages added by developers inside the controller body</li>
<li>different methods for levels: trace/debug/info/warn/error/fatal</li>
</ul>
</li>
</ul><p><strong>Example:</strong>  </p><pre><code><code class="source-code prettyprint">controller({ params, logger }: HapiRequest) {
  try {
      logger.info({ data: params });

      ...do stuff...
  } catch(err) {
    logger.error(&apos;Personalized Error Message&apos;);
  }

  ... return things?...
}</code>
</code></pre><h2>Other processes</h2><p>By design, pino just outputs logs to be used by other &quot;transporters&quot; (other node processes spawned in
production and development) for reacting to, and viewing these logs. here are some examples of processes
we recommend implementing:</p><h3>Logrotate</h3><p>Log Rotation on production servers should be handled via another service as described in the <a href="http://getpino.io/#/docs/help?id=log-rotation">pino documention</a></p><h3>Pino-Pretty</h3><p>Displays the logs in a prettier format that makes it easier to see the data, however takes up more space.
To use, pipe the log file to pino-pretty executable:
<code>tail -f logs/pino.log | ./node_modules/.bin/pino-pretty -t</code>  </p><p>See <a href="https://github.com/pinojs/pino-pretty#cli-arguments">CLI arguments</a> for more control of output:</p><ul>
<li>remove <code>-t</code> for epoch</li>
<li><code>-s</code> for searching</li>
<li><code>-i</code> for ignoring properties
e.g.<pre><code><code class="source-code prettyprint">[2020-03-22 05:58:27.175 +0000] INFO  (72753 on Devlins-MacBook-Air.local): request completed
req: {
  &quot;id&quot;: &quot;1584855457513:Devlins-MacBook-Air.local:72753:k82m08u1:10001&quot;,
  &quot;method&quot;: &quot;put&quot;,
  &quot;url&quot;: &quot;http://localhost:3333/api/note/1&quot;,
  &quot;headers&quot;: {
    &quot;host&quot;: &quot;localhost:3333&quot;,
    &quot;connection&quot;: &quot;keep-alive&quot;,
    &quot;content-length&quot;: &quot;17&quot;,
    &quot;accept&quot;: &quot;*/*&quot;,
    &quot;sec-fetch-dest&quot;: &quot;empty&quot;,
    &quot;user-agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36&quot;,
    &quot;content-type&quot;: &quot;application/json&quot;,
    &quot;origin&quot;: &quot;http://localhost:3333&quot;,
    &quot;sec-fetch-site&quot;: &quot;same-origin&quot;,
    &quot;sec-fetch-mode&quot;: &quot;cors&quot;,
    &quot;referer&quot;: &quot;http://localhost:3333/docs/swagger/index.html&quot;,
    &quot;accept-encoding&quot;: &quot;gzip, deflate, br&quot;,
    &quot;accept-language&quot;: &quot;en-US,en;q=0.9&quot;,
    &quot;cookie&quot;: &quot;SQLiteManager_currentLangue=2; _pk_id.2.1fff=e04c4083531e55a4.1584819760.6.1584855171.1584855171.; _pk_ses.2.1fff=1&quot;
  },
  &quot;remoteAddress&quot;: &quot;127.0.0.1&quot;,
  &quot;remotePort&quot;: 64175
}
res: {
  &quot;statusCode&quot;: 200,
  &quot;headers&quot;: {
    &quot;content-type&quot;: &quot;application/json; charset=utf-8&quot;,
    &quot;vary&quot;: &quot;origin&quot;,
    &quot;access-control-allow-origin&quot;: &quot;http://localhost:3333&quot;,
    &quot;access-control-expose-headers&quot;: &quot;WWW-Authenticate,Server-Authorization&quot;,
    &quot;cache-control&quot;: &quot;no-cache&quot;,
    &quot;content-length&quot;: 4
  }
}
responseTime: 6</code>
</code></pre></li>
</ul><h2>Notes/Ideas</h2><ul>
<li>Trace logging any external requests/responses</li>
<li>Logger Helper for use in the dataservices</li>
<li>goaccess?</li>
<li>websocket? endpoint that shows logs in real time</li>
<li>docs page for logs (searching?)</li>
<li>Elasticsearch/Logstash/Kibana</li>
<li>logrotate on production</li>
</ul></div>
        <a data-ice="link" href="manual/README.logging.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Controllers</h1><p>Controllers are functions that handle requests to specific endpoint paths:</p><pre><code><code class="source-code prettyprint">function controllerFunction(request) {
    ... do stuff and return a message ...
}</code>
</code></pre><p>The first parameter passed in is the <a href="https://github.com/hapijs/hapi/blob/master/API.md#request for HapiRequest">HapiRequest</a> object</p><p>We define the mapping from endpoint/method to controller function with an JSON object:</p><pre><code><code class="source-code prettyprint">const map1 = {
  path: &quot;/endpoint&quot;,
  method: &quot;GET&quot;, ///
  controller: controllerFunction
}</code>
</code></pre><p>To make this endpoint available to the server, we need to export an array of these mappings:</p><pre><code><code class="source-code prettyprint">export default [ map1, map2, ... ];</code>
</code></pre><h2>Notes/Ideas</h2><ul>
<li>OPTIONS requests?</li>
<li>Do not instantiate classes to handle requests. This would be a huge memory overhead!<ul>
<li>From Walmart interview: class methods bad for memory as we don&apos;t want to instantiate a class in memory. Seems like that isn&apos;t true for static functions though... <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static</a></li>
<li>I prefer creating classes with <strong>static</strong>  methods for encapsulation for testing and documentation purposes</li>
</ul>
</li>
<li>DO NOT USE SHARED CLASS PROPERTIES/STATEFUL VARIABLES IN CONTROLLER FUNCTIONS<ul>
<li>These functions need to be stateless.</li>
</ul>
</li>
<li><strong>IDEA:</strong> Catch any exceptions that don&apos;t have response code and log or email indicating unexpected state</li>
<li><strong>IDEA:</strong> generic CRUD endpoints with a flexible storage system for prototypes<ul>
<li>/{objectType}/create</li>
<li>/{objectType}/read/{id}</li>
<li>/{objectType}/update/{id}</li>
<li>/{objectType}/delete/{id}</li>
<li>/{objectType}/all?filters?fields?</li>
<li>/{objectType}/search?q</li>
</ul>
</li>
</ul></div>
        <a data-ice="link" href="manual/README.controllers.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Dataservices</h1><p>Dataservices abstract the communication with storage systems or external APIs to fetch/store data related to a
topic or for a specific UI component.</p><h2>Examples</h2><h3>Note Dataservice</h3><p>Create/Read Note objects out of a mariadb/mysql database</p><h2>Notes/Ideas</h2><ul>
<li>Quick storage dataservice (abstracted away from specific object?)<ul>
<li>takes object from post/put request and places in mongodb</li>
<li>objects indexed by another param</li>
<li>automatically assigned id</li>
<li>retrieves with get request</li>
<li>delete request<ul>
<li>takes multiple object ids</li>
</ul>
</li>
<li>search/or retrieve by property?</li>
</ul>
</li>
</ul></div>
        <a data-ice="link" href="manual/README.dataservices.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Helpers</h1><p>Helpers are classes that modularize some functionality that is useful in the server.</p><h2>Examples</h2><h3>MariaDB</h3><p>Helper class for connecting with mariadb server and saving/retrieving rows from tables</p><pre><code><code class="source-code prettyprint">- query
- insert
- fetch
- fetchOne</code>
</code></pre><h3>Config</h3><p>Helper class for reading properties from <a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/conf/config.yaml#L3">config file</a></p><ul>
<li>provides a typed interface of these properties</li>
</ul><h3>Healthcheck</h3><p>Helper for building the healthcheck response that is displayed at <code>&lt;CONFIG.PATHS.healthceck&gt;</code> endpoint.</p><ul>
<li>Determines version/branch and if the server is running properly</li>
<li>Makes simple requests to configured dependency DB/External Services to see if they are available</li>
</ul><h2>Notes/Ideas</h2><ul>
<li><strong>IDEA:</strong> Should healthcheck read log file for past minute to see if any errors?</li>
<li>Do we want/need to worry about Dependency Injection/Singletons?</li>
<li>RDBMS vs Document store<ul>
<li>CAP theorem stands for C &#x2013; Consistency, A &#x2014; Availability, P &#x2014; Partitioning (or Scalability) and states that having all three properties at the same time is not possible,</li>
<li><a href="https://medium.com/statuscode/three-reasons-to-use-a-nosql-document-store-for-your-next-web-application-6b9eabffc8d8">https://medium.com/statuscode/three-reasons-to-use-a-nosql-document-store-for-your-next-web-application-6b9eabffc8d8</a></li>
<li>Document Store:<ul>
<li>use for settings data and where schema will be changed often</li>
<li>when changes are small crud, based on users interactions?</li>
<li>when count and aggregate data is useful to end user</li>
</ul>
</li>
<li>RDBMS:<ul>
<li>less duplicated data, normalized and stored in specific tables</li>
<li>useful when data changes often</li>
<li>seems like more useful for storing fact data in ETL processes?</li>
<li>Q: phoenix?</li>
</ul>
</li>
</ul>
</li>
</ul></div>
        <a data-ice="link" href="manual/README.helpers.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Git Hooks/Workflow</h1><p>We use githooks(<a href="https://github.com/devlinjunker/template.hapi.rest/tree/master/scripts/hooks">github</a>) to help clean up and enforce the workflow for developers. This is done with Husky.</p><p><strong>NOTE: We prevent commits to master branch on local machine (so all changes to master are PRs on github)</strong>. You may want to disable this for more rapid local development, you can just remove the configuration in package.json(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/package.json#L30">github</a>) that adds these hooks.</p><h2>On commit</h2><p>Before each commit, we want to verify that the build won&apos;t break. So we make sure to run the build process one more time with only the committed files before
letting the commit go through:</p><p>Process:</p><ol>
<li>Stash uncommited changes</li>
<li>Run linting/flow/compliation and tests with npm/webpack</li>
<li>Pop uncommitted changes</li>
</ol><h2>Github Actions</h2><p>We setup github actions on this project so we can enforce actions/checks and workflow processes on github.</p><h3>On Master PR</h3><p>For every PR against master, we spin up a server to build the project via node/webpack. We also lint the
project at this point (with more stringent error rules?). This will help us catch any errors in the code and
prevent any merges to master that will break</p><h3>On Merge to Master</h3><p>Whenever we merge a PR to master, we want to update the documentation based on the changes the user made in
the commits. We run a git action to handle this as well:</p><ul>
<li>Collect README files and update wiki</li>
<li><strong>TODO:</strong> Fix/remove links from wiki?</li>
<li><strong>TODO:</strong> Build documentation and generate commit</li>
<li><strong>IDEA:</strong> Version increase/changelog generation</li>
</ul><p>More to come...</p></div>
        <a data-ice="link" href="manual/README.scripts.html"></a>
      </div>
    </div>
<div class="manual-card-wrap" data-ice="cards">
      <div class="manual-card">
        <div data-ice="card"><h1>Test</h1><p>Testing bootstrap file(<a href="https://github.com/devlinjunker/template.hapi.rest/blob/master/test/test.bootstrap.js">github</a>)
finds all of the test files and imports global objects that can be used in all tests to simplify each test
file. Also creates a sinon Sandbox that is reset before each test for mocking/stubbing services and non-tested
functions in the test context.</p><p>To run the tests with mocha, use <code>npm run test</code> to see the output from all tests in <code>.spec</code> files in the
standard output.</p><p>Global Imports (available in all <code>.spec</code> files):</p><ul>
<li><code>sinonSandbox</code> from <a href="https://sinonjs.org/">Sinon</a></li>
<li><code>expect</code> from <a href="https://www.chaijs.com/">Chai</a></li>
<li><code>describe</code>/<code>it</code>/<code>beforeEach</code> from <a href="https://mochajs.org/">Mocha</a></li>
</ul><h2>Notes/Ideas</h2><ul>
<li>[ ] Look into differences between webpack tests vs <code>npm test</code></li>
<li><strong>IDEA:</strong> Mocha settings/plugin for displaying filepath in output of tests (when erroring?)<ul>
<li>seems difficult to do on async/timeout errors</li>
</ul>
</li>
</ul></div>
        <a data-ice="link" href="manual/README.test.html"></a>
      </div>
    </div>
</div>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>

<script src="script/github-link.js"></script>

</body>
</html>
