<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl">
  <title data-ice="title">Home | HapiServer</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
  <script src="script/matomo.js"></script>
<meta name="description" content="Template for Hapi Server"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="HapiServer"><meta property="twitter:description" content="Template for Hapi Server"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a href="swagger/index.html">API</a>
  <a id="healthcheck" href="">Healthcheck</a>

  <script>
    var el = document.getElementById('healthcheck')
    if (window.location.href.indexOf('github') == -1) {
      el.href = '../../admin/status';
    } else {
      el.style.color = 'grey';
      el.style.cursor = 'not-allowed';
      el.title = 'Unavailable on Github Hosting'
    }
  </script>
<a style="position:relative; top:3px;" href="https://github.com/devlinjunker/template.node.hapi"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-main">main</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#base">base</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/base/server.js~RequestError.html">RequestError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/base/server.js~Server.html">Server</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#controllers">controllers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controllers/hello.controller.js~HelloWorld.html">HelloWorld</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/controllers/note.controller.js~NoteController.html">NoteController</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#dataservices">dataservices</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/dataservices/note.service.js~NoteDataservice.html">NoteDataservice</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#helpers">helpers</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/helpers/healthcheck.helper.js~HealthcheckHelper.html">HealthcheckHelper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/helpers/mariadb.helper.js~MariaDBHelper.html">MariaDBHelper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CONFIG">CONFIG</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-healthcheckHelper">healthcheckHelper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-mariadbHelper">mariadbHelper</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><div data-ice="index" class="github-markdown"><h1 id="basic-webpack-server-app">Basic Webpack Server App</h1><p>This is meant to be an example of how to use Webpack in the Backend for rapid development of an API server
with endpoints for managing requests and connections to other servers and/or database/storage tools.</p>
<p>This example can also be used to quickly create a server with your own endpoints to do whatever you would like
on any requests (either user/interaction based, or with a cron job to make it on a scheduled basis)</p>
<h2 id="dependencies">Dependencies</h2><p>Node v10+ and npm
  (tested with v10.15.1)</p>
<p>See <a href="https://github.com/devlinjunker/template.node.hapi/blob/master/package.json">package.json</a> for full list of current dependencies</p>
<ul>
<li>Hapi v18</li>
<li>Webpack + Loaders</li>
<li>Babel</li>
<li>FlowJS</li>
<li>ESLint</li>
<li>Mocha, Chai, Sinon</li>
<li>EsDoc</li>
<li>MariaDB</li>
<li>YamlJS</li>
</ul>
<h2 id="development">Development</h2><p>How to use this template to create a quick HTTP REST server:</p>
<ol>
<li>Download and update dependencies</li>
<li>Update <code>conf/config.yaml</code> with any changes to settings</li>
<li>Add new OpenAPI endpoint to <code>./openapi.yaml</code></li>
<li>Add Unit tests in <code>src/controllers/</code> (Test Driven Development)</li>
<li>Add Controller Files to <code>src/controllers/</code><ul>
<li>For now, add reference to controller in <code>src/entry.js</code> (with other controllers)</li>
<li>Controller endpoints will be served at <code>/api</code> (or whatever is set in config.yaml)</li>
</ul>
</li>
<li>Run <code>npm run start-watch</code> to compile and run server + tests in watch mode</li>
<li>Navigate to <a href="http://localhost:3333/docs/swagger/index.html">http://localhost:3333/docs/swagger/index.html</a> to see swagger-ui with your new endpoint</li>
</ol>
<h3 id="tests-running">Tests/Running</h3><p><code>npm run start-watch</code> to run open the server and run Webpack to watch for changes, recompiling, running the tests and restarting the server when it is done</p>
<p><code>npm run test-watch</code> to run Mocha and with all tests associated with the project, watch for changes on the files to re-run the tests</p>
<p><code>npm run dev-watch</code> to run only webpack to watch for changes on the files and recompile/rerun tests</p>
<p><code>npm run test</code> to run all of the unit tests for the application one time</p>
<p><code>npm run dev</code> to run a development version of the server</p>
<p><code>npm run build</code> to compile development version of server to <code>dist/</code></p>
<p><code>npm run doc</code> to generate static documentation in the doc folder</p>
<p><code>npm run lint</code> to run linter and see any errors/warnings</p>
<p><code>npm run clean</code> clean the workspace (remove <code>dist/</code>)</p>
<p><code>npm run help</code> to print the contents of <code>help.txt</code> to the command line</p>
<p><strong>TODO</strong></p>
<p><code>npm run build-prod</code> ... TODO: compile application to production version</p>
<p><code>npm start</code> .. TODO: start production Server</p>
<p><code>npm stop</code> .. TODO: stop production Server</p>
<p><code>npm restart</code> will restart once start/stop completed</p>
<h2 id="todo">TODO</h2><ul>
<li>[x] (^) Node 8</li>
<li>[x] (^) Webpack  <ul>
<li><a href="https://medium.com/@christossotiriou/speed-up-nodejs-server-side-development-with-webpack-4-hmr-8b99a932bdda">https://medium.com/@christossotiriou/speed-up-nodejs-server-side-development-with-webpack-4-hmr-8b99a932bdda</a>  </li>
<li>[x] babel<ul>
<li>[x] sourcemap support</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-source-map-support#description">https://www.npmjs.com/package/babel-plugin-source-map-support#description</a></li>
</ul>
</li>
<li>[x] flow webpack plugin - typechecking each compilation</li>
<li>[x] eslinting  </li>
<li>[x] test with mocha</li>
<li>[x] nodemon to run server</li>
</ul>
</li>
<li>[x] (^) Fix watch commands so that tests can run and output errors without breaking<ul>
<li>[x] mocha shouldn&apos;t stop the process</li>
<li>[x] tests should run again on changes with webpack</li>
</ul>
</li>
<li>[x] (^) OpenAPI (Swagger) Documentation and ESDoc Plugin <a href="https://swagger.io/docs/specification/about/">https://swagger.io/docs/specification/about/</a>  <ul>
<li>[v] OpenAPI Validation  </li>
<li>[x] Swagger UI<ul>
<li>[x] in Docs</li>
</ul>
</li>
</ul>
</li>
<li>[x] (^) Debugging while running<ul>
<li>use <code>node --inspect dist/server.bundle.js</code> to start debugger and a node debugging tool to attach</li>
</ul>
</li>
<li>[x] (^) Update Linting Rules (linewrap, length, etc)  <ul>
<li>[x] ensuring files start with a comment <a href="https://github.com/Stuk/eslint-plugin-header">https://github.com/Stuk/eslint-plugin-header</a>  </li>
<li>[x] Require Comments <a href="https://eslint.org/docs/rules/require-jsdoc">https://eslint.org/docs/rules/require-jsdoc</a> and valid <a href="https://eslint.org/docs/rules/valid-jsdoc">https://eslint.org/docs/rules/valid-jsdoc</a>  </li>
<li>[x] Naming Conventions <a href="https://github.com/airbnb/javascript#naming-conventions">https://github.com/airbnb/javascript#naming-conventions</a></li>
<li>[x] Test Rules<ul>
<li><a href="https://www.npmjs.com/package/eslint-plugin-mocha">https://www.npmjs.com/package/eslint-plugin-mocha</a></li>
<li><a href="https://github.com/jest-community/eslint-plugin-jest">https://github.com/jest-community/eslint-plugin-jest</a><ul>
<li>Jest plugin doesn&apos;t seem to allow configs of only some rules</li>
</ul>
</li>
</ul>
</li>
<li>[x] all variables flow typed?</li>
<li>[x] filenames: <a href="https://www.npmjs.com/package/eslint-plugin-filenames">https://www.npmjs.com/package/eslint-plugin-filenames</a></li>
<li>[x] import/export rules: <a href="https://www.npmjs.com/package/eslint-plugin-import">https://www.npmjs.com/package/eslint-plugin-import</a></li>
</ul>
</li>
<li>[x] (^) Chai as promised and sinon-chai</li>
<li>[..] (^) Simple DB endpoint  <ul>
<li>[..] PostgreSQL or MariaDB<ul>
<li><a href="https://mariadb.com/kb/en/library/connector-nodejs-promise-api/">https://mariadb.com/kb/en/library/connector-nodejs-promise-api/</a></li>
<li>[ ] SQL scripts in repo to init database... update schema later...
= [ ] (^) Sequelize? <a href="https://sequelize.org/v5/">https://sequelize.org/v5/</a></li>
</ul>
</li>
</ul>
</li>
<li>[..] (^) Config.yaml (and Env config file?)<ul>
<li>port</li>
<li>database</li>
<li>other services/apis later?</li>
<li>[ ] overrides</li>
</ul>
</li>
<li>[x] (^) Healthcheck<ul>
<li>Server status</li>
<li>MariaDB</li>
<li>External Service</li>
<li>[x] Link to in docs</li>
<li>[x] Version?</li>
</ul>
</li>
<li>[x] (^) cleanup old builds</li>
<li>[x] (-) Madge for Dependency graph</li>
<li>[x] (-) Githooks for generating reports/linting  <ul>
<li>[x] Run tests and cancel on tests fail</li>
<li>[ ] Different actions on different branch names?</li>
</ul>
</li>
<li>[..] Github actions<ul>
<li>[x] Run build and test</li>
<li>[ ] Run <code>doc</code> command before commit on develop branch<ul>
<li>[ ] after merge</li>
</ul>
</li>
<li>[ ] Check if READMEs exist at each directory level?</li>
<li>[ ] Check if spec files exist (except where special comment in file header)</li>
</ul>
</li>
<li>[..] (^) Improve logging<ul>
<li>[x] configuration</li>
<li>~rotate~</li>
<li>[x] pino-pretty</li>
<li>[ ] slack message on error?</li>
</ul>
</li>
<li>[ ] (^) Hapi Improvements<ul>
<li>[ ] (-) Use Hapi Error (in production? not dev?) <a href="https://www.npmjs.com/package/hapi-error">https://www.npmjs.com/package/hapi-error</a></li>
<li>Dev Errors in log <a href="https://www.npmjs.com/package/hapi-dev-errors">https://www.npmjs.com/package/hapi-dev-errors</a></li>
<li>Hapi Swagger <a href="https://github.com/glennjones/hapi-swagger">https://github.com/glennjones/hapi-swagger</a></li>
<li>Joi object/param validation <a href="https://hapi.dev/family/joi/">https://hapi.dev/family/joi/</a></li>
<li>Simple Authentication for Healthcheck/Logging <a href="https://hapi.dev/tutorials/auth/">https://hapi.dev/tutorials/auth/</a></li>
<li>Advanced Authentication</li>
</ul>
</li>
<li>[ ] (^) GoAccess log analyzer<ul>
<li><a href="https://goaccess.io/">https://goaccess.io/</a></li>
</ul>
</li>
<li>[ ] (-) Websocket Logging Endpoint<ul>
<li>display logs and any new logs at endpoint</li>
</ul>
</li>
<li>[ ] (v) Test coverage saved in spec files  </li>
<li>[ ] (v) Babel Istanbul(NYC) plugin <a href="https://github.com/istanbuljs/babel-plugin-istanbul">https://github.com/istanbuljs/babel-plugin-istanbul</a>  </li>
<li>[ ] (v) Istanbul (NYC) Reporters <a href="https://github.com/istanbuljs/istanbuljs/tree/master/packages/istanbul-reports/lib">https://github.com/istanbuljs/istanbuljs/tree/master/packages/istanbul-reports/lib</a>  <ul>
<li>Read test results report on webpage in docs site</li>
</ul>
</li>
<li>[ ] (-) Uptime Robot to check if app/website/api is alive or not</li>
<li>[ ] (-) Request Performance</li>
<li>[ ] (-) Helpers<ul>
<li>[..] mysql</li>
<li>[ ] external-service request (with performance monitoring/caching?)</li>
<li>[..] healthcheck using db and external service configs</li>
<li>[ ] (^) Authentication</li>
<li>[ ] (^) Logging<ul>
<li>GELF/Kibana?</li>
<li>Winston/Bunyon</li>
</ul>
</li>
<li>[ ] SendEmail (mailchimp?)</li>
<li>[ ] Cron?</li>
<li>[ ] ElasticSearch? for search endpoint</li>
</ul>
</li>
<li>[ ] (-) Request Details Model attached to handler parameters</li>
<li>[ ] (-) Compression of responses</li>
<li>[ ] (-) Run only affected tests on file save  </li>
<li>[ ] (-) Typescript/(Express?) router<ul>
<li>[ ] Routing Decorators and Validation <a href="https://github.com/typestack/routing-controllers">https://github.com/typestack/routing-controllers</a><ul>
<li>Headers</li>
<li>Cookies?</li>
</ul>
</li>
<li>[ ] OpenApi Decorators for openapi docs generation <a href="https://github.com/epiphone/routing-controllers-openapi">https://github.com/epiphone/routing-controllers-openapi</a><ul>
<li>Newman (Postman) Auto Test Generation: <a href="https://github.com/dtzar/openapi-auto-test">https://github.com/dtzar/openapi-auto-test</a></li>
</ul>
</li>
<li>[ ] Automatically find controller files in entry rather than need to reference  </li>
<li>[ ] Proper error messages/codes from endpoints<ul>
<li><a href="https://www.restapitutorial.com/httpstatuscodes.html">https://www.restapitutorial.com/httpstatuscodes.html</a></li>
</ul>
</li>
<li>[ ] MongoDB<ul>
<li>for quick development? (objects on the fly)</li>
</ul>
</li>
</ul>
</li>
<li>[ ] (-) production vs dev<ul>
<li>webpack/build</li>
<li>pm2 for production</li>
<li>config</li>
<li>log rotation</li>
</ul>
</li>
<li>[ ] (-) Require Node v8 and recommend v10 on build</li>
<li>[ ] (-) <code>bin/</code> directory with script named <code>node.hapi</code> for starting/stopping prod<ul>
<li>could be a javascript script file...</li>
</ul>
</li>
<li>[ ] (-) Onboarding Documentation<ul>
<li>Environment Setup (IDEs, Building, Deployment, Repos)</li>
<li>Overview of Architecture</li>
<li>Resources for Languages/Frameworks/Libraries</li>
<li>Coding Standards</li>
<li>Technical Process (reviews, issue management, story lifecycle)</li>
<li>Domain Specific Language (Jargon)</li>
<li>Roles and Responsibilities</li>
</ul>
</li>
<li>[ ] (?) Absolute Paths:<ul>
<li>maybe: <a href="https://itnext.io/configure-absolute-paths-with-create-react-app-and-flow-e4b8922676a2">https://itnext.io/configure-absolute-paths-with-create-react-app-and-flow-e4b8922676a2</a></li>
<li>or: <a href="https://www.npmjs.com/package/app-module-path">https://www.npmjs.com/package/app-module-path</a></li>
<li>[x] fix <code>__dirname</code> param in webpack/node with config and solve docs paths</li>
</ul>
</li>
<li>[..] (v) ESDoc plugins <a href="https://medium.com/trabe/understanding-esdoc-plugins-d9ee9095d98b">https://medium.com/trabe/understanding-esdoc-plugins-d9ee9095d98b</a>  </li>
<li>[ ] (v) Cucumber.js for BDD(Behavior Driven Development) testing <a href="http://cucumber.github.io/cucumber-js/">http://cucumber.github.io/cucumber-js/</a>  </li>
<li>[x] (v) ESDoc Manual with src READMEs <a href="https://doc.esdoc.org/github.com/esdoc/esdoc/manual/feature.html#integration-manual">https://doc.esdoc.org/github.com/esdoc/esdoc/manual/feature.html#integration-manual</a>  </li>
<li><del>[ ] Docsify?</del>  </li>
</ul>
<h3 id="application">Application</h3><ul>
<li>[..] GET/POST/PUT/DELETE Note endpoints</li>
<li>[x] Serve Docs<ul>
<li>[x] (v) ~only in development~ with config setting</li>
</ul>
</li>
<li>[ ] Websocket<ul>
<li>Log output to website &amp; file instead of console<ul>
<li>config.yaml settings</li>
</ul>
</li>
</ul>
</li>
<li>[ ] External API endpoint<ul>
<li>Weather (in UI?)</li>
<li>(Garbage UPC) Map to information/notes?</li>
</ul>
</li>
<li>[ ] Connect to Google Drive/Oauth</li>
<li>[ ] Authorized vs Unauthorized endpoints</li>
<li>[ ] SSO Server</li>
</ul>
<h2 id="issues">Issues</h2><p><strong>Issues when properties missing/misnamed in controller route objects</strong>
TODO: add issues</p>
<p><strong>Issues when controllers/routes being duplicated</strong>
TODO: add issues</p>
<p><strong>Issues with wrong node version (&lt;8)</strong>
TODO: add issues</p>
<p><strong>Issues when not using babel/polyfill</strong></p>
<pre><code><code class="source-code prettyprint">events.js:183
      throw er; // Unhandled &apos;error&apos; event
      ^

Error: spawn mocha ENOENT
    at Process.ChildProcess._handle.onexit (internal/child_process.js:190:19)
    at onErrorNT (internal/child_process.js:362:16)
    at _combinedTickCallback (internal/process/next_tick.js:139:11)
    at process._tickCallback (internal/process/next_tick.js:181:9)</code>
</code></pre><ul>
<li>Made sure using node v8 and re-ran <code>npm install -D</code></li>
</ul>
<pre><code><code class="source-code prettyprint">module.js:550
    throw err;
    ^

Error: Cannot find module &apos;babel-polyfill&apos;</code>
</code></pre><ul>
<li>Commented out line <code>polyfill: &quot;@babel/polyfill&quot;,</code> in webpack.config.js</li>
<li>re-ran webpack <code>npm run build</code></li>
<li>then uncommented line and ran <code>npm run start-watch</code></li>
</ul>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>

</body>
</html>
